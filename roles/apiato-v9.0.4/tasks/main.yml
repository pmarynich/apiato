---
- name: Copy archive to app server
  copy:
    src: /root/apiato-v9.0.4.zip
    dest: /root/apiato-v9.0.4.zip 

- name: Create dir for unarchive
  file:
    path: /var/www/apiato-v9.0.4
    state: directory
    owner: root
    group: root

- name: Unarchive
  command: unzip -n /root/apiato-v9.0.4.zip -d /root/v9.0.4

- name: Pull
  command: cp -r /root/v9.0.4/root/apiato-v9.0.0/ /var/www/apiato-v9.0.4

- name: Synchronization
  command: rsync /var/www/apiato-v9.0.4/ /var/www/apiato

- name: Run artisan migrate
  command: php /var/www/apiato/artisan migrate
